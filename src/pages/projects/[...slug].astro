---
import { getCollection } from "astro:content";

import Link from "@/components/common/Link.astro";
import BaseLayout from "@/layouts/BaseLayout.astro";

export async function getStaticPaths() {
  const projectsEntries = await getCollection("projects");
  return projectsEntries.map((entry) => ({
    params: { slug: entry.id.toString() },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { data } = entry;
---

<BaseLayout pageSubtitle={data.description} pageTitle={data.name}>
  <div class="space-y-8">
    <div class="space-y-6">
      {
        data.image && (
          <div class="flex justify-center">
            <img
              alt={data.image.alt}
              class="w-full max-w-3xl rounded-lg shadow-lg"
              src={`/images/projects/${data.image.url}.png`}
            />
          </div>
        )
      }

      <div class="space-y-4">
        <div class="prose dark:prose-invert max-w-none">
          <p class="text-lg font-light">{data.description}</p>
          <p class="text-sm text-gray-600 dark:text-gray-400">
            Created in {data.date}
          </p>
        </div>
      </div>
    </div>

    <div class="flex flex-wrap gap-4">
      {
        data.url && (
          <Link
            class="rounded-lg bg-blue-500 px-6 py-3 text-white transition-colors duration-200 hover:bg-blue-600"
            external
            href={data.url}
          >
            View Project
          </Link>
        )
      }

      <Link
        class="rounded-lg border border-gray-300 px-6 py-3 transition-colors duration-200 hover:bg-gray-50 dark:border-gray-600 dark:hover:bg-gray-700"
        href="/projects"
      >
        Back to Projects
      </Link>
    </div>
  </div>
</BaseLayout>
