---
import { getCollection } from "astro:content";

import BaseLayout from "@/layouts/BaseLayout.astro";

export async function getStaticPaths() {
  const books = await getCollection("books");
  return books.map((entry) => ({
    params: { id: entry.id },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { author, cover_image, date_read, title } = entry.data;
---

<BaseLayout>
  <article class="mx-auto mt-8 max-w-3xl">
    <div class="flex flex-col items-center gap-6 sm:flex-row">
      <img
        alt={cover_image.cover_image_alt}
        class="h-auto w-40 rounded-sm object-cover shadow-sm sm:w-48"
        decoding="async"
        height="288"
        loading="eager"
        src={cover_image.cover_image_url}
        width="192"
      />
      <div class="space-y-2">
        <h1 class="font-serif text-3xl font-semibold">{title}</h1>
        <p class="text-lg opacity-80">by {author}</p>
        {
          date_read && (
            <p class="text-sm opacity-70">
              Read on {new Date(date_read).toLocaleDateString()}
            </p>
          )
        }
      </div>
    </div>
  </article>
</BaseLayout>
