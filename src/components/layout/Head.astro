---
import { ViewTransitions } from "astro:transitions";

let { description, title } = Astro.props;

const ogImage = new URL("opengraph.png", Astro.url);
const canonicalURL = new URL(Astro.url.pathname, Astro.site);
---

<head>
  <!-- Global Metadata -->
  <meta charset="utf-8" />
  <meta content="width=device-width,initial-scale=1" name="viewport" />
  <meta content={Astro.generator} name="generator" />
  <link href="/favicon.png" rel="icon" type="image/png" />
  <link href="/apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180" />
  <link href="/favicon.png" rel="icon" sizes="32x32" type="image/png" />
  <link href="/favicon.png" rel="icon" sizes="16x16" type="image/png" />
  <link href="/sitemap-index.xml" rel="sitemap" />
  <meta content="#2e2e2e" name="msapplication-TileColor" />
  <meta content="#fff7f3" name="theme-color" />

  <!-- DNS Prefetch for external domains -->
  <link href="//links.alexandremouriec.com" rel="dns-prefetch" />
  <link href="//github.com" rel="dns-prefetch" />
  <link href="//mamot.fr" rel="dns-prefetch" />

  <!-- Preconnect to external domains -->
  <link href="https://links.alexandremouriec.com" rel="preconnect" />
  <link href="https://github.com" rel="preconnect" />
  <link href="https://mamot.fr" rel="preconnect" />

  <link
    href={new URL("blog/feed.xml", Astro.site)}
    rel="alternate"
    title="Alexandre's Blog RSS Feed"
    type="application/rss+xml"
  />

  <link
    href="https://links.alexandremouriec.com/feed/rss?"
    rel="alternate"
    title="Alexandre's Curation RSS Feed"
    type="application/rss+xml"
  />

  <!-- Primary Meta Tags -->
  <title>
    {Astro.url.pathname === "/" ? title : `${title} - Alexandre Mouriec`}
  </title>
  <meta content={title} name="title" />
  <meta content={description} name="description" />

  <!-- Open Graph / Facebook -->
  <meta content="website" property="og:type" />
  <meta content={Astro.url} property="og:url" />
  <meta content={title} property="og:title" />
  <meta content={description} property="og:description" />
  <meta content={ogImage} property="og:image" />

  <!-- Twitter -->
  <meta content="summary_large_image" name="twitter:card" />
  <meta content={Astro.url} name="twitter:url" />
  <meta content={title} name="twitter:title" />
  <meta content={description} name="twitter:description" />
  <meta content={ogImage} name="twitter:image" />
  <meta content="@mrcalexandre" name="twitter:site" />
  <meta content="@mrcalexandre" name="twitter:creator" />

  <!-- Fediverse -->
  <meta content="@mrcalexandre@mamot.fr" name="fediverse:creator" />

  <!-- IndieWeb -->
  <link href="https://github.com/mrcalexandre" rel="me" />

  <!-- Canonical URL -->
  <link href={canonicalURL} rel="canonical" />
  {
    canonicalURL && (
      <>
        <link href={canonicalURL} rel="canonical" />
        <meta content="article" property="og:type" />
        <meta content={title} property="og:title" />
        <meta content={description} property="og:description" />
        <meta content={Astro.url} property="og:url" />
        <meta content={title} property="og:site_name" />
        <meta content={ogImage} property="og:image" />
        <meta content={title} name="author" />
        <meta content="Written by" name="twitter:label1" />
        <meta content={title} name="twitter:data1" />
      </>
    )
  }

  <!-- Favicon -->
  <link href="/favicon.svg" rel="icon" type="image/x-icon" />

  <!-- Critical CSS Inline -->
  <style>
    /* Critical CSS for above-the-fold content */
    body {
      margin: 0;
      font-family: Inter, system-ui, sans-serif;
    }
    .font-serif {
      font-family: EBGaramond, serif;
    }
    .text-3xl {
      font-size: 1.875rem;
      line-height: 2.25rem;
    }
    .font-medium {
      font-weight: 500;
    }
    .italic {
      font-style: italic;
    }
    .text-xl {
      font-size: 1.25rem;
      line-height: 1.75rem;
    }
    .font-light {
      font-weight: 300;
    }
    .opacity-80 {
      opacity: 0.8;
    }
    .mb-12 {
      margin-bottom: 3rem;
    }
    .pb-2 {
      padding-bottom: 0.5rem;
    }
    .max-w-4xl {
      max-width: 56rem;
    }
    .mx-auto {
      margin-left: auto;
      margin-right: auto;
    }
    .py-8 {
      padding-top: 2rem;
      padding-bottom: 2rem;
    }
  </style>

  <!-- Font Preloads with higher priority -->
  <link
    as="font"
    crossorigin
    href="/fonts/EBGaramondVariable-Italic.woff2"
    rel="preload"
    type="font/woff2"
  />
  <link
    as="font"
    crossorigin
    href="/fonts/EBGaramondVariable.woff2"
    rel="preload"
    type="font/woff2"
  />
  <link
    as="font"
    crossorigin
    href="/fonts/InterVariable-Italic.woff2"
    rel="preload"
    type="font/woff2"
  />
  <link
    as="font"
    crossorigin
    href="/fonts/InterVariable.woff2"
    rel="preload"
    type="font/woff2"
  />

  <!-- View Transitions -->
  <ViewTransitions />
</head>
